<button mat-icon-button [matMenuTriggerFor]="notificationMenu" (menuOpened)="loadNotifications()" matTooltip="Notifications">
  <mat-icon [matBadge]="unreadCount" [matBadgeHidden]="unreadCount === 0" matBadgeColor="warn">
    notifications
  </mat-icon>
</button>

<mat-menu #notificationMenu="matMenu" class="notification-menu">
  <div class="notification-header" (click)="$event.stopPropagation()">
    <h3>Notifications</h3>
    <button mat-button color="primary" (click)="markAllAsRead()" [disabled]="unreadCount === 0">
      Mark all read
    </button>
  </div>
  <mat-divider></mat-divider>

  <div class="notification-list" *ngIf="!loading && notifications.length > 0">
    <mat-list>
      <ng-container *ngFor="let notification of notifications; let last = last">
        <mat-list-item 
          (click)="onNotificationClick(notification)"
          [class.unread]="!notification.isRead"
          class="notification-item">
          <div class="notification-content">
            <div class="notification-icon-wrapper">
              <mat-icon [color]="getNotificationColor(notification.type)">
                {{ getNotificationIcon(notification.type) }}
              </mat-icon>
            </div>
            <div class="notification-body">
              <div class="notification-title">{{ notification.title }}</div>
              <div class="notification-message">{{ notification.message }}</div>
              <div class="notification-time">{{ getTimeAgo(notification.createdAt) }}</div>
            </div>
            <div class="notification-actions">
              <button 
                mat-icon-button 
                (click)="deleteNotification(notification.id, $event)"
                matTooltip="Delete">
                <mat-icon>delete</mat-icon>
              </button>
            </div>
          </div>
        </mat-list-item>
        <mat-divider *ngIf="!last" [inset]="true"></mat-divider>
      </ng-container>
    </mat-list>
  </div>

  <div class="notification-empty" *ngIf="!loading && notifications.length === 0">
    <mat-icon>notifications_none</mat-icon>
    <p>No notifications</p>
  </div>

  <div class="notification-loading" *ngIf="loading">
    <mat-icon>hourglass_empty</mat-icon>
    <p>Loading...</p>
  </div>
</mat-menu>
